---
import { Image } from "astro:assets";
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";
import Header from "../components/Header.astro";
import getBlogCollection from "../lib/getBlogCollection.ts";
import { SITE_DESCRIPTION, SITE_TITLE } from "../consts";

const posts = (await getBlogCollection(Astro.url)).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
    <style>
      main {
        width: 960px;
      }
      ul {
        display: flex;
        flex-wrap: wrap;
        gap: 2rem;
        list-style-type: none;
        margin: 0;
        padding: 0;
      }
      ul li {
        width: calc(50% - 1rem);
      }
      ul li * {
        text-decoration: none;
        transition: 0.2s ease;
      }
      ul li:first-child {
        width: 100%;
        margin-bottom: 1rem;
        text-align: center;
      }
      ul li:first-child .title {
        font-size: 2.369rem;
      }
      ul li img {
        margin-bottom: 0.5rem;
        border-radius: 12px;
      }
      ul li a {
        display: block;
      }
      .title {
        margin: 0;
        color: rgb(var(--black));
        line-height: 1;
      }
      .date {
        margin: 0;
        color: rgb(var(--gray));
      }
      ul li a:hover h4,
      ul li a:hover .date {
        color: rgb(var(--accent));
      }
      ul a:hover img {
        box-shadow: var(--box-shadow);
      }
      @media (max-width: 720px) {
        ul {
          gap: 0.5em;
        }
        ul li {
          width: 100%;
          text-align: center;
        }
        ul li:first-child {
          margin-bottom: 0;
        }
        ul li:first-child .title {
          font-size: 1.563em;
        }
      }
    </style>
  </head>
  <body>
    <Header />
    <main>
      <h1>History in Archives</h1>
      <p>
        I'm Trey Pendragon! I work with a team who dreams of making it normal
        for anyone to engage with history that's made every day for new and
        fun discoveries. To see how we can do that I've started this little blog
        where every week I'll find a single object that catches my eye and see
        what I can learn about it, then reflect on what would have made that
        journey more pleasant. The posts are stream of consciousness from a
        person who speaks one language, dropped out of college, and still loves
        to learn new things about the world. I hope this is fun!
      </p>
      <section>
        <ul>
          {
            posts.map((post) => (
              <li>
                <a href={`./blog/${post.id}/`} class="w-full">
                  <div class="flex w-full max-h-[360px] overflow-hidden">
                    {post.data.ogImage && (
                      <Image
                        width={720}
                        height={360}
                        src={post.data.ogImage}
                        class="object-cover object-top w-full pb-4"
                        alt=""
                      />
                    )}
                  </div>
                  <h4 class="title">{post.data.title}</h4>
                  <p class="date">
                    <FormattedDate date={post.data.pubDate} />
                  </p>
                </a>
              </li>
            ))
          }
        </ul>
      </section>
    </main>
    <Footer />
  </body>
</html>
